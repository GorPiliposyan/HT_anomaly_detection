#include <SPI.h>
#include <Adafruit_INA219.h>
#include <SD.h>
#define MUX_Address 0x70

//Adafruit_INA219 ina219_A1(0x40);
Adafruit_INA219 ina219_B1(0x41);
Adafruit_INA219 ina219_C1(0x44);
Adafruit_INA219 ina219_A2(0x40);
Adafruit_INA219 ina219_B2(0x41);
Adafruit_INA219 ina219_C2(0x44);


File PowConsFile;
//File debugFile;
//File TimingFile;
//File yPredFile;
const int chipSelect = 4;
//int alarm = 3;
#define HT_cont_pin  3
int alarm2 = 9;




// ///////////////Store ML related parameters////////////////

int Nsv = 596;
int vec_size = 10; // Write this manually to avoid unnecessarily complicated code
float gamma = 0.009;

// The intercept
float RO = -0.10134; 

// The support vector coefficients multiplied by 10,000. Note, all elements of the array should be max 65535, otherwise uint_16_t will overflow
const uint16_t alpha[] PROGMEM =  {
    776,  181,   88,  358,  222,  132,   29,  603,  901,  329,  936,  148,  221,   47,   31,   39,   58,   63,  254,  103,   46,  173,  834,  275,  340,  486,  259,  395,  950,  451,  184,   35,  673,  325,  247,   86,  929,  709,  911,  172,  236,  745,  184,  222,  102,   63,   46,  396,  423,   24,  329,  139,  177,   28,  283,  164,  183,  104,  100,  311,  290,  383,  341,  287,  376,    9,  301,  167,   72,   61,  224,  281,  243,  302,   75,   12,   82,  140,   71,   96,  159,  103,   90,  243,   19,  173,   21,   92,   35,   15,   38,   10,  101,  219,   20,  193,  400,   44,   86,   32,  452,  116,  283,   57,  272,  243,   83,  110,  567,   10,   50,  232,   44,  232,   95,   81,   26,  253,  131,   49,  226,   99,   73,  151,   46,  129,  182,   22,   43,  190,  139,  413,  315,   65,   55,   71,  243,  279,   10,   20,  160,  157,   77,  118,  459,  122,  247,  198,  456,  152,  137,  305,  283,   50,  269,    9,  220,  162,  275,   63,   70,   48,  271,   14,   61,  277,    9,   48,   91,  182,  217,  363,  114,  264,   14,  150,  160,  437,  132,  339,  163,  232,  269,  367,  181,  255,  242,   55,  362,   21,   99,  312,  104,  212,   20,  308,  237,    9,   75,  323,  341,   85,   32,  226,   35,   15,   90,  282,   18,  525,  260,   61,  396,  374,   73,   24,  315,  150,  200,  305,  323,  482,    5,  202,  154,   54,  387,  100,  167,   65,  309,  137,   68,  257,   45,  362,  239,  247,  128,  123,  303,   40,  100,  312,  368,   21,   11,   54,  496,  367,  191,  196,   31,  113,   78,  254,  410,  523,   68,  350,  110,  177,  240,  553,  177,   52,  213,  135,   64,  343,  265,   97,  100,  181,   16,   11,  104,   62,  241,  447,  201,   15,   98,  101,  186,   20,   81,  486,  204,   14,  136,   16,  171,  219,   27,  104,   81,  233,  169,   18,  214,  295,  379,   19,   26,  122,   37,  262,   22,  426,  367,   98,   26,   44,   19,  421,   92,  229,   51,  141,  103,   10,  406,  402,  148,  237,  281,  141,  267,  108,  151,  347,   58,  208,  454,  117,  385,   76,  133,   28,  571,  117,  105,   73,  112,  122,   49,  180,  270,  155,  235,   53,  451,   10,  440,  326,  156,   38,  441,  311,   79,   81,   77,  203,   81,  220,  324,  254,  138,  121,  151,  263,  254,  221,  167,  362,  154,   20,   16,  237,  146,   22,  220,   67,  273,  107,   51,   33,  199,  429,   85,  277,  299,  264,  106,  275,  145,  177,  401,   57,   64,  236,  309,   56,  129,   63,  122,   46,   56,  162,  152,  218,  330,  262,   81,   61,   39,  324,   22,  164,  174,   93,   92,  157,   55,   99,  374,  339,  297,  204,   63,  172,  354,  119,   24,  313,  346,  535,  114,  141,  137,  112,  179,   37,  202,  290,  127,   95,   13,  262,   98,  327,   11,  257,  359,  468,  211,  462,  142,   50,  228,  126,  148,   73,  119,  102,  239,   84,   23,  415,   30,   74,  185,  229,   28,  105,   36,   19,  518,  181,   72,   98,  283,  196,  125,   28,  465,    9,  122,  338,   12,  288,    7,  274,  148,   17,  273,    9,   44,  338,   34,  214,  234,  213,  202,  206,   66,  157,  148,  275,  177,  120,  251,  243,   80,   16,  520,  181,  252,  220,   84,  197,   99,  149,   68,  129,   43,   47,  181,   89,  165,  121,  148,  347,  498,  490,   65,  271,   49,    6,   30,  178,   49,  193,   48,  310,   78,  303,  250,   55,  254,  322,  186,  266,   24,   58,   56,  304,  308,  429,  128,  288,  189,  117,  187,   38,    5,  229,  164,  133,   58,   87,  177,   34,  272,  447,   98,  243,  122,  123,   26,  165,   84,  300,   52,  273,   27,  432,   63,   90,  633,   93,  219,  315,  181,  105

    };


// The support vectors. Note, all elements of the array should be max 65535, otherwise uint_16_t will overflow
const uint16_t SupportVectors[] PROGMEM = {
    4300,    3900,   26400,    4800,     700,    4460,    3820,   26260,    1640,     820,
    1500,    5200,   26400,    3100,    2900,    1240,    4140,   26200,    3740,    3880,
    4800,    3300,   26200,    4100,    3300,    4680,    3460,   26220,    4280,    4100,
    1100,    3400,   25700,    1000,    1000,    1140,    3640,   26240,     840,     800,
     800,     800,   26700,     700,    4100,    1020,     920,   26480,     780,    3300,
    4300,    3300,   25700,     700,    3100,    4280,    3580,   26180,     840,    3860,
    4800,    1000,   25900,     800,    2900,    4440,    1000,   26200,     800,    3880,
    4300,    5100,   26700,     800,    2600,    4380,    4000,   26380,     800,    2560,
    1100,    3900,   26200,    4800,    1000,    1100,    3760,   26400,    1680,     880,
    1000,    5100,   26700,    1000,    1000,    1000,    4080,   26600,     880,     860,
    1000,    3800,   26500,    2800,     800,    1040,    3680,   26480,    3520,    2900,
     800,    3800,   26700,    2900,    2600,    1100,    3680,   26460,    3740,    3800,
    4900,     700,   25900,     700,     700,    4740,     900,   26120,     760,     840,
    1100,    1000,   25900,    3100,    1000,    1060,     880,   26180,    3600,     840,
    4100,    3400,   26400,    1000,    1000,    4420,    3480,   26360,     900,     900,
    4600,     700,   26100,    2800,     700,    4320,     900,   26260,    3440,     900,
    1100,    3600,   26500,     700,    4800,    1160,    3720,   26280,     800,    3280,
    4800,    3600,   25900,     800,    1000,    4640,    3800,   26280,    1340,     820,
    1000,    1000,   26500,    2900,    2600,    1160,     980,   26380,    2940,    3580,
    1300,    1000,   26700,     800,    2800,    1140,    1020,   26480,     820,    3760,
    4900,    1100,   25900,     700,    2800,    4800,     960,   26300,     840,    3220,
    4800,     800,   26200,    2900,    1000,    4440,     840,   26140,    2980,     840,
    1100,    3600,   26500,    3300,     700,    1160,    3700,   26400,    1380,     900,
    4900,    3800,   26400,    4100,    3100,    4720,    4280,   26400,    3300,    2940,
    3800,    1000,   26700,     800,     700,    4120,     860,   26400,     820,     840,
    1100,    3400,   26700,     700,    2500,    1080,    3640,   26540,     760,    2560,
     800,     800,   25900,    1000,     800,    1120,     920,   26080,     920,     780,
    1300,    3800,   26500,    1000,    2800,    1220,    4760,   26560,     840,    3220,
    4900,    1100,   26500,     800,    2800,    2600,     980,   26480,     880,    3340,
    4400,    3400,   26200,    4600,     800,    4320,    4060,   26340,    2300,     820,
    4900,    3400,   26400,     800,    1000,    4660,    3500,   26440,     920,     940,
    4600,    1100,   26100,    2800,     800,    4600,    1040,   26400,    3040,     840,
    1000,    3400,   26100,     800,    3900,    1120,    3900,   26440,     780,    4962,
    4900,    1000,   25900,     800,    4300,    4660,     980,   26160,     880,    2980,
    4800,     700,   26400,    4100,    4600,    4760,     760,   26340,    4120,    4420,
    1000,    1000,   26100,    2900,     800,     960,     960,   26480,    3260,     860,
    4400,    1000,   26700,    1000,    1000,    2680,    1020,   26460,     860,     780,
     800,     800,   26400,    4100,    2800,     940,     900,   26400,    4140,    4595,
    1100,    1100,   26700,     800,    1000,    1180,     900,   26520,     840,    3180,
    4600,    1100,   26200,    4100,     800,    4440,     940,   26993,    3740,     880,
    3900,    3900,   26700,     800,    1000,    4260,    3620,   26540,     780,     880,
    1000,    3900,   26500,    3900,    3900,    1100,    3760,   26280,    2040,    3420,
    4800,    1000,   26500,    2900,     700,    4760,     940,   26340,    3440,     780,
    1100,     700,   26700,    2900,    1000,    1080,     940,   26500,    3100,     900,
    1500,    5100,   26700,    2900,    1000,    1280,    4000,   26520,    3360,     860,
    4800,     800,   26200,    4300,    4600,    4680,     980,   26340,    3480,    3260,
    1300,    1000,   25700,    4300,    3800,    1200,     960,   26120,    3840,    3980,
    4900,     700,   26500,    4100,    2900,    4880,     900,   26240,    3560,    2800,
    4800,     700,   26100,     800,    4800,    4520,     960,   26260,     780,    4340,
    1000,    3800,   26700,    2900,    4100,    1040,    4040,   26520,    2860,    3100,
    1300,    5200,   25900,    1000,    2900,    1140,    4100,   26140,     840,    3940,
    4600,    3600,   25700,    4100,    2600,    4380,    4020,   26220,    3660,    3340,
    5100,    3400,   26200,     800,    2900,    4960,    3680,   26360,     780,    3700,
    4400,     800,   25900,    3300,    4600,    4420,     900,   26260,    3300,    4180,
    1300,     700,   25900,    4300,    4600,    1080,     860,   26220,    4220,    4340,
    1000,    3400,   25900,     800,     800,    1100,    3800,   26360,     800,    1600,
    4400,     700,   26500,    3100,    1000,    5113,     900,   26460,    3540,     860,
    1800,    1000,   26500,     800,     700,    1320,     840,   26380,     840,     840,
    4800,    3800,   26500,    4100,    4600,    4400,    3920,   26420,    3560,    4300,
    3900,    1000,   26700,    3100,     800,    4060,     980,   26580,    3860,     900,
    4400,    3800,   25700,    3100,    4300,    4460,    3820,   26080,    3960,    3960,
    4100,     800,   26100,    1000,    2600,    4360,     940,   26540,     860,    2640,
    1300,    1000,   26500,     700,    4100,    1876,     960,   26420,     740,    3900,
    1300,    3300,   25900,    4300,    4600,    1200,    3680,   26180,    4300,    4260,
    4600,    1000,   26400,    1000,    2900,    5182,    1060,   26160,     920,    3680,
    4800,     800,   26500,    1000,    4300,    4800,     900,   26460,     860,    3000,
    4800,    3400,   25700,    1000,    2600,    4540,    3800,   25940,     880,    3660,
    1100,    3600,   26700,    1000,     700,    1140,    3920,   26540,    1360,     880,
    1300,    4900,   26500,    4400,    4100,    1260,    3820,   26460,    4260,    3860,
    4800,    3400,   25900,    3900,    1000,    4480,    4260,   26160,    3420,     820,
     800,    1100,   25900,    3400,    2600,    1080,     980,   26180,    4080,    3780,
    1800,    1000,   26400,    3100,    3100,    1180,     960,   26400,    3800,    3540,
    4800,     800,   26200,    3100,    1500,    4440,     900,   26320,    3460,    1020,
    1300,     800,   26400,    4100,     700,    1080,     940,   26440,    3460,    1580,
    1300,    1100,   26400,    4100,    4100,    1140,     940,   26340,    4040,    2980,
    3800,    4900,   26500,    3900,    3900,    4220,    3960,   26440,    3280,    3780,
    4600,    3300,   26500,    1000,    2600,    4640,    3460,   26220,    1000,    2760,
    1100,    5100,   26700,     800,    2800,    1180,    4560,   26560,     800,    3240,
    4300,    3600,   25900,    2900,    2500,    4440,    3640,   26140,    2980,    2660,
    4400,    3400,   26500,    4100,    3900,    4440,    3660,   26600,    3380,    2860,
    4400,    5100,   25700,    3100,     700,    4520,    3880,   26080,    3540,     880,
    1100,    3800,   26700,    2900,    2900,    1080,    3820,   26500,    3020,    3920,
    1000,    1000,   26100,    2900,    3800,    1060,     980,   26320,    2980,    4120,
    4400,    3400,   26700,    2900,    2600,    4400,    3640,   26500,    2940,    2680,
    4400,     800,   25700,    3100,    3400,    4580,     820,   25940,    3700,    3480,
    1300,    4900,   26100,    1000,    4100,    1080,    4600,   26360,     920,    3620,
    4100,    1100,   26700,    3400,    4100,    4400,    1000,   26600,    2960,    3080,
    1300,    4900,   26700,    3800,    3900,    1220,    4140,   26540,    3920,    3960,
    4300,    1100,   26500,    4100,    1500,    4400,     880,   26380,    3340,    1100,
    4800,    5100,   26200,    3100,     700,    4680,    4080,   26260,    3020,     840,
    4800,    3800,   26500,     800,    4600,    4600,    3600,   26340,     820,    3100,
    1100,    3600,   25700,    3300,    4400,    1200,    3540,   26180,    3360,    3640,
    4100,    3800,   26200,    2800,    2600,    4500,    3520,   26320,    3060,    2580,
    4300,    5200,   25900,    4300,     700,    4300,    4360,   26340,    3720,     740,
    3900,    4100,   26700,    1000,    3900,    4200,    4000,   26380,     860,    2940,
    3900,    3800,   25700,    4100,    3900,    4380,    3820,   26060,    3260,    3200,
    4600,    1000,   26500,    4600,    1000,    4380,     960,   26280,    4560,     900,
     800,    3800,   25900,    3100,    4400,    1000,    3580,   26100,    3760,    3860,
    1100,    4300,   26400,    1500,     800,    1180,    4000,   26300,     960,     900,
    4800,    1000,   26400,    3600,    1000,    4860,     860,   26220,    4160,     960,
    3900,    1000,   26100,    2900,    3900,    4280,    1000,   26300,    2860,    2860,
    3900,    5100,   26400,    4300,    3900,    4080,    4060,   26360,    3460,    3760,
    4900,    5100,   25900,    3100,    3100,    4640,    3940,   26100,    3840,    3700,
    4300,    5100,   25700,    4400,    4100,    4580,    3980,   26160,    3800,    3700,
    4400,    1000,   26400,    4100,    4300,    4520,     940,   26240,    3780,    2700,
    4100,    3900,   26400,     700,    4400,    4460,    4400,   26300,     780,    3040,
    4400,    3800,   25700,     800,    2600,    4420,    4080,   26100,     880,    3780,
    4400,    4400,   26500,    4400,    3900,    4300,    4280,   26480,    4300,    4020,
    4800,     700,   26700,     700,    2600,    4800,     940,   26400,     800,    2660,
    1100,    5100,   25900,     700,    4100,    1120,    4200,   26260,     780,    3360,
    1000,    5200,   25900,    3100,     700,    1140,    4220,   26100,    3660,     780,
     800,    3800,   25700,    3100,    2600,    1100,    3900,   26040,    3780,    3740,
    1300,    3400,   26700,    3800,    1000,    1160,    4340,   26520,    3500,     920,
    4600,    3600,   25700,     800,    4600,    4560,    4100,   25940,     920,    4000,
    1500,    3100,   26400,    4300,    4100,    1140,    3560,   26240,    3680,    3840,
    3800,    4100,   26400,    4100,    1000,    3960,    4020,   26340,    3220,     860,
    1000,    4100,   26200,    3100,    4400,    1100,    4100,   26160,    3900,    4280,
    4300,    3100,   26400,    4600,    1000,    4380,    3700,   26140,    4160,     900,
    4300,    1000,   26100,     800,    3900,    4340,    1000,   26260,     800,    2580,
    4600,    5100,   26700,     700,    2900,    4480,    3980,   26460,     860,    3860,
    1800,    3900,   26400,     800,    3900,    1180,    3660,   26320,     820,    3680,
    4400,    3300,   26400,    3900,    2600,    4460,    3540,   26020,    4040,    4000,
    1100,    3400,   26400,    4600,     800,    1120,    4220,   26380,    4240,     880,
    4100,    3800,   26500,    3100,    3600,    4020,    3880,   26480,    2980,    4120,
    4800,    3400,   26500,    1000,    4800,    4680,    3820,   26240,     780,    3940,
    1100,    3400,   26500,    4400,    3900,    1080,    4200,   26340,    4320,    4060,
    4300,    4900,   25900,    4400,    4100,    4480,    3900,   26080,    4060,    4200,
    1100,    4900,   26700,    1000,    3800,    1180,    3860,   26300,     860,    3100,
    1300,    3800,   26500,    4100,    1500,    1220,    3780,   26340,    3900,     960,
    1100,    3600,   25900,     700,    4800,    1120,    4080,   26200,     800,    4140,
    4100,    3800,   26500,    1000,    2600,    4320,    4240,   26480,     820,    2680,
    1300,    5100,   26700,    2900,     700,    1080,    4220,   26500,    2860,     760,
    4900,    5200,   26400,    3100,    1000,    4500,    3980,   26240,    3800,     940,
    4400,    3800,   26700,    2800,    2500,    4420,    3780,   26620,    2840,    2760,
    4800,    4600,   25700,    2900,     800,    4540,    3800,   26160,    3560,     900,
    4800,    3400,   26400,    1000,    2600,    4720,    3560,   26360,     880,    2680,
    4300,    3400,   25900,     700,    2800,    4400,    3420,   26180,     800,    2680,
    1100,    3800,   26400,    4300,    4100,    1060,    4060,   26280,    3600,    2680,
    3900,    4100,   26500,     700,    2800,    4140,    3720,   26440,     820,    3440,
    5100,    3400,   26200,     700,    2900,    4860,    3620,   26240,     760,    3780,
    3800,    1000,   26500,    2900,    4100,    4140,     920,   26440,    3680,    4060,
    4300,    1000,   26500,    4100,    2900,    4500,     960,   26300,    4000,    2820,
    4800,    3600,   26400,    4100,    4800,    4620,    3580,   26220,    4060,    4380,
    1000,     800,   25700,    3300,    4100,    1200,     920,   26080,    3500,    3140,
    4600,    3600,   26500,     800,    4100,    4480,    3640,   26400,     860,    2480,
    1100,    5100,   26700,     700,    1000,    1060,    4620,   26440,     860,    1000,
    4100,     800,   26100,    4300,    1000,    4300,     900,   26320,    2900,     860,
    1800,    3400,   25900,    3800,     800,    1240,    3800,   26280,    3460,     920,
    1100,    4100,   26500,    2900,    4300,    1120,    3700,   26400,    3000,    2880,
    4300,    1000,   26400,    4100,    2800,    4040,    1020,   26380,    4100,    3760,
    1100,    4800,   26100,     800,    4100,    1140,    3720,   26160,     780,    4180,
    4300,    3800,   26700,    2900,    4300,    4380,    3760,   26620,    2880,    3120,
    1100,    1000,   26700,    2900,    4100,    1160,     880,   26620,    2900,    2940,
    1300,    3400,   25900,    1000,    2600,    1080,    4260,   26340,     880,    2940,
    1300,     800,   26100,    2900,    4300,    1160,     860,   26440,    2880,    3080,
     800,     800,   26400,    3100,    2900,    1120,     900,   26180,    3740,    2820,
    1300,    3900,   25700,    3100,    4100,    1220,    3720,   25880,    3640,    3560,
    1000,    1000,   26100,    1500,    1000,    1100,     860,   26380,    1000,     860,
    4300,    4100,   26700,    2800,    2600,    4200,    3620,   26440,    3400,    3800,
    1300,    5100,   26700,     800,    2600,    1160,    3980,   26400,     760,    2960,
    4100,    4900,   26700,    1000,    1300,    4300,    4040,   26520,     960,     960,
    3800,    3600,   26500,    3800,    4100,    3920,    3840,   26480,    3300,    3920,
    4300,    1000,   26400,    4100,     800,    4420,     960,   26380,    2680,     860,
    3800,     800,   26500,    3800,    3900,    3980,     880,   26460,    3980,    3940,
    1100,    3600,   26500,    1000,     800,    1040,    3800,   26400,    1460,     880,
    4800,    3400,   25700,    3100,    2500,    4520,    3640,   25920,    3660,    3580,
    4600,    5100,   26500,     700,    1000,    4600,    4640,   26440,     800,     900,
    4400,    3100,   26400,    1000,    4600,    4320,    3540,   26340,     860,    3640,
    4400,    3800,   26500,     800,    1000,    4420,    3680,   26260,     820,    1520,
    4100,    1000,   25700,    4300,    4100,    4440,     920,   25840,    3520,    3320,
    4400,    1000,   25900,    4100,    2600,    4440,     960,   26240,    3340,    2900,
    4600,     700,   26700,     800,     800,    4500,     860,   26560,    1440,     780,
    4300,    3300,   25900,     800,    4100,    4220,    4320,   26180,     780,    4000,
    1500,    3400,   26400,    2900,    2500,    1240,    3560,   26500,    3680,    3680,
    4600,    4900,   25700,    1000,    2800,    4460,    3820,   26060,     840,    3640,
    3900,    3600,   26700,     700,    3900,    4020,    4060,   26460,     760,    3940,
    1300,    1100,   26400,    4800,     700,    1260,     980,   26400,    4140,     780,
     800,     800,   25900,     700,    2800,    1060,     840,   26120,     820,    4000,
    4900,    3800,   26200,     700,    1000,    5151,    3800,   26200,     800,     920,
    3800,    3400,   26100,    4100,    3900,    4040,    3440,   26260,    3960,    3940,
    1300,     800,   26500,     700,     800,    1863,     920,   26400,     800,     920,
    1300,    1000,   26400,    1000,    2600,    1120,     960,   26300,    1340,    3500,
    1000,    4300,   26700,     800,    2600,    1080,    3780,   26480,     840,    4000,
    1100,    1000,   26700,    2900,    4300,    1100,     960,   26480,    3020,    4140,
    4800,    3800,   26100,    2900,    2800,    4580,    4340,   26340,    2980,    2680,
    4100,    3300,   26700,    1000,    2900,    4320,    3700,   26620,     820,    2760,
    1100,    5100,   25900,    3100,    3100,    1060,    4100,   26200,    3800,    3940,
    3900,    5100,   26500,    3900,    4100,    4220,    3940,   26480,    3520,    3440,
    1100,    4900,   25700,     800,     700,    1120,    3860,   26220,     820,     800,
    1100,    4300,   26700,    1000,    4100,    1080,    3760,   26260,     820,    3080,
    1300,    5200,   26500,     700,    4100,    1060,    4080,   26380,     780,    4000,
    3800,    1000,   26500,    2900,     800,    4200,     880,   26500,    2860,     900,
    4900,    3400,   26200,    3100,     700,    4740,    4160,   26400,    3100,     860,
    1100,    4900,   26500,     800,    2800,    1080,    4660,   26360,     740,    2820,
    1500,    4100,   25700,    4400,    3800,    1180,    4000,   26140,    3860,    3440,
    1800,     800,   26700,    1000,    1000,    1260,     900,   26520,     840,     960,
    4800,    1000,   26500,    4100,    2600,    4500,     940,   26380,    4140,    3860,
    4600,    3600,   26400,     800,    1000,    4380,    3880,   26380,     800,    1540,
    4600,    3300,   25700,    4400,    4300,    4560,    4040,   26120,    4100,    3940,
    1100,    5100,   25900,    3100,    2600,    1020,    4160,   26020,    3680,    2980,
    4300,    4100,   26500,    2900,    4100,    4360,    4460,   26360,    2900,    2980,
     800,    3600,   26400,    4100,    2600,    1040,    4220,   26280,    3700,    3420,
    1100,    4400,   25900,    4600,     800,    1040,    3980,   26240,    4340,     960,
    1300,     800,   26200,    3300,    4600,    1180,     920,   26300,    4100,    4280,
    4300,    3600,   26100,     700,    2500,    4440,    3560,   26200,     780,    2580,
    4100,     700,   26500,    3300,    4400,    4180,     860,   26440,    3280,    4380,
    1000,     800,   25900,    3300,    4300,    1160,     960,   26260,    4080,    4280,
    4300,     800,   26700,    2900,    4300,    4180,     940,   26520,    2900,    3800,
    1100,    3400,   26500,    1000,     700,    1220,    4460,   26400,     800,     900,
    4600,     800,   25700,    1300,     700,    4340,     880,   26020,     880,     860,
    4300,    5100,   25700,    3900,    4100,    4460,    4000,   26120,    3500,    3300,
    3900,     700,   25900,    3400,     700,    4140,     900,   26040,    3300,     800,
    4600,    1100,   25900,    2900,    2500,    4480,     880,   26120,    3700,    3900,
     800,    1000,   26500,    4300,    4800,    1020,     900,   26380,    3480,    3840,
    1300,     700,   26700,    2900,    3900,    1120,     960,   26520,    3700,    3940,
    4600,    4900,   25900,    4400,    4100,    4640,    3760,   26100,    4040,    3620,
    1000,     800,   25700,    1000,    4600,    1120,     840,   26020,     960,    4080,
    4100,    1000,   26500,    3100,    4300,    4060,     940,   26340,    3140,    4320,
    1300,    5100,   25900,    4300,     700,    1180,    4120,   26280,    3500,     820,
    1800,    1000,   26200,    3100,     800,    1260,    1000,   26440,    3540,     880,
    3800,     800,   26500,     800,    4300,    4220,     920,   26580,     860,    3120,
    4300,    3900,   25700,    4400,    1000,    4380,    3480,   25980,    4520,     880,
    1100,    4400,   26700,     700,    2600,    1120,    3840,   26440,     820,    2660,
    4100,    3900,   26100,    3100,    4300,    4220,    3920,   26300,    3100,    4300,
    4900,    3400,   26200,     700,    4400,    4620,    3440,   26260,     760,    4440,
    4100,    3800,   26700,    2800,    2900,    4380,    3680,   26440,    2840,    2660,
    4900,    3300,   26400,     800,     800,    4560,    4480,   26400,     820,     860,
    4800,    3300,   26400,     800,    3300,    4500,    3380,   26260,     840,    4060,
    4300,    5100,   25700,    4100,     800,    4420,    4140,   26220,    3420,     880,
    4100,    3600,   26400,    2900,    2600,    4320,    3560,   26320,    3060,    2520,
    4400,    5100,   26400,    2900,    2600,    4400,    4100,   26340,    2940,    2820,
    3800,    1100,   26700,    3100,    1000,    4080,     960,   26620,    2960,     880,
    1300,    3800,   26200,    3300,    4100,    1160,    4540,   26300,    3140,    3200,
    1100,    3600,   26400,    1000,     700,    1820,    3700,   26500,     800,     880,
    1100,    3600,   25700,     800,    4100,    1120,    3560,   25900,     920,    3780,
    1100,    5200,   26700,    4100,    1000,    1060,    4520,   26520,    3900,     920,
    1000,    1100,   26500,    3600,     700,    1060,     920,   26420,    4480,     880,
     800,    3400,   26500,     700,    2900,    1000,    3560,   26480,     900,    4020,
    4300,    3600,   26400,    4400,     700,    4380,    3600,   26460,    4600,     720,
    4100,     500,   25900,     500,    3800,    4400,     840,   26360,     760,    3660,
    4600,    1000,   25700,    4300,    4800,    4500,     960,   25880,    3740,    3860,
    4100,    4900,   25700,     800,    4100,    4320,    4260,   26060,     840,    3460,
    4800,    3300,   26200,     700,    4600,    4680,    3720,   26280,     800,    3140,
    1100,    5400,   25900,     700,     800,    1120,    4360,   26180,     760,     820,
    1100,    5200,   26400,    1000,    2600,    1140,    3880,   26260,     960,    2780,
    4800,    3300,   26400,    4100,    4100,    4760,    3500,   26000,    3400,    3160,
    4400,    3600,   26100,    2800,    2500,    4440,    4260,   26240,    3540,    3180,
    3800,    1000,   26500,    2900,    4100,    4040,     940,   26520,    2940,    3760,
    4300,     700,   26700,    2900,    2600,    4140,     940,   26340,    2940,    3800,
    4600,    4800,   26700,    2900,    1000,    4400,    4440,   26540,    2840,     900,
    1300,    3800,   26200,    4100,    2600,    1120,    3820,   26320,    3340,    2760,
    1300,    5200,   26100,    2900,    2900,    1220,    4180,   26220,    3060,    2800,
    1000,    4800,   26500,    4100,     800,    1100,    4440,   26420,    3160,     800,
    4600,    3900,   25900,    2900,    2900,    4520,    3720,   26220,    3340,    4080,
    4300,    4300,   25700,    4400,    4100,    4320,    4100,   26080,    4120,    4180,
    1000,    3400,   25900,    3100,    2800,    1140,    3640,   26100,    2980,    2720,
     800,    3400,   26400,    4300,    2900,    1120,    3540,   26340,    4280,    3900,
    1100,     800,   26700,    2900,    2500,    1180,     920,   26600,    2920,    2540,
     800,    5200,   26500,    2900,    2600,    1020,    4320,   26460,    3120,    3280,
     800,    3900,   26500,    3300,    4600,    1100,    3680,   26340,    3920,    4300,
    4800,    3400,   26500,    3300,    2600,    4340,    3860,   26320,    3180,    3840,
    4600,    3400,   25700,    4300,    4300,    4340,    3640,   25920,    4020,    4280,
     800,    5100,   26400,     800,     700,     960,    4720,   26360,     880,     780,
    4300,    1100,   26700,     800,    4100,    3720,    1040,   26580,     820,    4100,
    3900,    5100,   26400,    4300,     800,    4420,    3960,   26380,    3580,     800,
    1300,    3300,   26400,    3300,    2600,    1160,    3660,   26460,    3000,    2680,
    1300,    1300,   26200,    2900,    3600,    1260,     920,   26260,    2880,    2860,
    1000,    5200,   26700,    3100,    2800,    1100,    4260,   26420,    3740,    3740,
    1100,    5100,   26100,    4600,    1000,    1020,    4060,   26260,    4120,     920,
    3800,    5100,   26400,     800,    4100,    4020,    4080,   26480,     860,    3760,
    4600,    4900,   25700,     800,     700,    4580,    3780,   26000,     840,     760,
     800,    4100,   25700,    3300,     800,    1140,    4020,   25960,    3680,     860,
    4400,    3100,   25700,    1000,    4300,    4520,    3680,   26080,     820,    3700,
    1000,    3400,   25900,    1000,    2800,    1100,    3520,   26140,     880,    2720,
    1100,    4300,   25700,     800,    4100,    1080,    4180,   26160,     840,    4100,
    1100,     700,   25900,    4300,    3900,    1100,     940,   26340,    3380,    3040,
     800,    4300,   26700,    1000,    4100,    1080,    4080,   26400,     840,    4160,
    1100,    3600,   26500,    4300,     800,    1180,    4420,   26420,    4180,     820,
     800,    3300,   25900,    4400,    4300,     980,    3460,   26160,    4260,    4220,
    4900,    3600,   26500,    4300,    4600,    4740,    3520,   26280,    4340,    4180,
     800,    1600,   26400,     800,    2900,    1100,     980,   26320,     780,    3620,
     800,    3400,   26100,    2900,    2600,    1100,    4060,   26360,    3520,    3740,
    4300,    5100,   26500,     800,    3900,    4440,    4560,   26280,     780,    3240,
    4300,    4900,   26400,    4300,     800,    4260,    4340,   26360,    4340,     920,
    1000,    3600,   25700,     700,    4300,    1040,    3760,   26020,     840,    3120,
    1300,    1100,   26700,    4100,    2900,    1260,    1000,   26480,    3640,    3700,
    1300,    5100,   26700,    4100,     700,    1300,    3960,   26560,    3500,     820,
    1100,    5100,   26400,    4400,    4100,    1020,    4120,   26100,    4300,    4100,
    4300,    5100,   26400,    4300,    4100,    4280,    3960,   26420,    3560,    4220,
    3900,    3900,   26400,    1000,    4100,    4500,    3520,   26460,     840,    4160,
    1300,    3800,   26500,    3100,    4400,    1040,    4040,   26280,    3860,    4240,
    1000,    3400,   25700,    3400,    2800,    1040,    3680,   26080,    4000,    3840,
    4300,    4900,   26700,     800,    2500,    4220,    4360,   26480,     820,    3480,
    4600,    3600,   26400,    1500,    1000,    4540,    3660,   26320,     960,     840,
    4800,    1100,   26400,     700,    4800,    4660,     960,   26220,     720,    3400,
    4800,    1100,   25900,    3100,    2800,    4820,    1000,   26220,    3820,    3100,
    4100,     800,   26700,    3100,    4100,    4400,     840,   26520,    3040,    2940,
    1100,    3400,   26100,    4100,    1000,    1120,    3120,   26200,    3740,     880,
    4400,    5100,   26400,    4400,    1000,    4520,    4440,   26320,    3800,     840,
    1300,    1000,   26700,     800,    1000,    1100,     960,   26480,     780,    1640,
    1100,    1500,   25900,    1000,    4100,    1020,    1100,   26360,     900,    4000,
    1800,    3900,   26700,     800,    1000,    1300,    3840,   26420,     760,     880,
    4800,    1100,   26400,     700,    1000,    5310,    1020,   26460,     760,     920,
     800,    3800,   26400,    1000,    4800,    1060,    3980,   26380,     860,    3680,
    3900,    1000,   26700,    2900,    1000,    4260,    1020,   26440,    2880,     840,
    1100,    1000,   26100,     800,    1500,    1080,     880,   26340,     840,    1060,
    1500,    3600,   25700,    4400,     800,    1220,    3760,   26060,    3900,     960,
    3900,    1000,   26100,    4400,    4100,    4000,     980,   26340,    3420,    3980,
    3900,    3800,   26400,    4100,    4100,    4420,    3640,   26420,    3520,    2980,
    1000,     800,   26400,    1000,    4800,    1040,     940,   26480,     880,    4500,
    4400,    1500,   26500,     700,    2600,    4320,     980,   26380,     900,    3500,
    4800,    1000,   26500,    3600,    1000,    4500,     980,   26420,    2760,     860,
    4900,     700,   26100,    3100,    2600,    4580,     880,   25960,    3940,    3520,
    3900,    4400,   26200,    4100,    3800,    4140,    4240,   26100,    4180,    4000,
    1300,    1500,   26100,    4300,    3900,    1200,    1080,   26200,    3840,    3480,
    1100,    3400,   25900,     700,    2600,    1100,    3720,   25960,     760,    3840,
    1300,    3400,   25700,    3800,    2900,    1120,    3540,   26220,    3840,    3980,
    3900,    1000,   25700,    3300,    1000,    4260,    1020,   26180,    3340,     940,
    1000,     700,   26100,    3300,    2600,    1100,     820,   26280,    4160,    3940,
    1300,     800,   25900,    4100,    2600,    1160,     900,   26160,    4140,    3900,
    1100,    4900,   25900,    2900,    1000,    1140,    4080,   26340,    2900,     960,
    4900,    3900,   26400,    3600,    1000,    4440,    3860,   26380,    2800,     960,
    4300,     800,   25700,    1000,    2900,    4360,     820,   25820,     920,    3520,
    1100,    3300,   26100,    1000,    4800,    1180,    3600,   26300,     880,    4200,
    4800,     500,   25900,    4100,     800,    4620,     900,   26200,    4220,     840,
    4800,    3600,   26200,    2900,    1000,    4800,    3680,   26100,    2980,    1000,
    1100,    5100,   26700,     800,    4100,    1220,    4340,   26560,     840,    3480,
    4100,    3900,   26200,    1500,    4100,    4360,    3680,   26340,     940,    3340,
    1100,    3100,   25700,    4300,    4100,    1100,    3900,   26280,    3500,    3520,
    4800,    3400,   26100,    4400,    2900,    4660,    3640,   26320,    4140,    3280,
    4400,    4900,   25700,    2900,     800,    4240,    3920,   26100,    3640,     860,
    4800,    3900,   26500,     700,    2900,    4640,    4500,   26460,     800,    2720,
    1300,     800,   26500,    4100,    2900,    1060,     900,   26420,    3840,    2800,
    4300,    4900,   26400,    4400,     800,    4400,    3740,   26420,    4240,     860,
    4800,    5400,   26500,     800,    1000,    4640,    4320,   26380,     760,     920,
    4400,    3900,   26400,    4300,    4100,    4300,    4400,   26400,    4260,    4060,
    1100,    3900,   26700,    2900,    1000,    1140,    4500,   26520,    2840,     900,
     800,    3400,   26400,    3400,     700,     980,    3700,   26060,    3980,     940,
    1100,    3800,   25700,    4100,    2900,    1120,    4020,   26120,    3520,    2920,
    4300,    5200,   26700,    1000,    2600,    4240,    4060,   26420,     840,    3460,
    1300,    1000,   26100,     800,    4300,    1160,     880,   26380,     820,    2620,
    4900,    3600,   25900,    1000,    4400,    4800,    3960,   26280,     840,    3200,
    4400,    3800,   25900,    2900,     700,    4200,    4160,   26240,    3820,     720,
    1300,    5200,   26700,    3100,    2600,    1120,    3960,   26420,    3660,    3660,
    3900,    3400,   26500,    3100,    1000,    4100,    3600,   26360,    3620,     900,
    4400,    5100,   25900,     800,    4100,    4240,    3980,   26240,     820,    4100,
    4300,    2900,   26200,    4100,    4100,    4380,    3560,   26240,    3460,    3400,
    5100,    1000,   25900,    3900,    4300,    4820,     980,   26260,    3880,    4240,
    1100,     800,   25900,    4600,    1000,    1180,     940,   26220,    4560,     800,
    5100,    1000,   26500,    3100,    2800,    4280,    1000,   26340,    3100,    3020,
    4400,    5100,   26100,    2800,     800,    4380,    4300,   26260,    2880,     960,
    4400,    3800,   26500,    3100,    2800,    4400,    4600,   26320,    3400,    3220,
    3900,    3900,   26700,    2900,    4300,    4040,    3760,   26400,    3660,    4100,
    3800,    3400,   26400,    1000,    3900,    4160,    3600,   26500,     920,    3260,
    4400,    3300,   25700,    1000,     700,    4440,    3980,   25980,     880,     900,
    4800,    3400,   26400,    4100,    4400,    4680,    4240,   26280,    3220,    3040,
    4300,    4800,   26400,     800,    4100,    4420,    3860,   26400,     800,    4340,
    4600,    3600,   26100,    3100,    2300,    4460,    3680,   26400,    2900,    2540,
    5100,    3800,   26400,    3100,     800,    4940,    3680,   26300,    4140,     840,
    4800,    3300,   26200,    4400,     700,    4960,    3500,   26300,    4080,     880,
     800,    3600,   25900,     700,    2600,    1040,    4240,   26160,     800,    3040,
    4900,    3300,   26100,    3400,    2800,    4640,    3860,   26040,    4180,    3900,
    4100,    3800,   25700,    3100,    4300,    4300,    3860,   25960,    3200,    3500,
    1300,    3800,   26700,    2900,    3900,    1080,    3780,   26520,    2880,    3840,
    1000,    3900,   26500,    2900,    2800,    1100,    4640,   26400,    3380,    3180,
    1000,    4100,   26500,    3300,    1000,    1040,    3580,   26340,    4280,     920,
    1000,    1000,   25900,    3600,     800,    1120,     880,   26360,    4440,     820,
    4400,    4900,   26400,     700,    4100,    4240,    4620,   26340,     820,    4020,
    1100,    4900,   26500,    2900,    2600,    1100,    4000,   26440,    2920,    2640,
    4600,     800,   26400,    1000,    4400,    4680,     980,   26260,     860,    2820,
    4300,    4900,   25700,     800,    4300,    4520,    4020,   26060,     800,    3660,
    1800,     700,   26500,    1000,    4100,    1300,     900,   26380,     840,    3600,
    4300,    3300,   26700,     800,    2800,    4140,    3840,   26400,     920,    3740,
    1100,     800,   26700,     800,    1000,    1040,     880,   26580,     860,    1580,
    4100,    3400,   26700,    4100,     700,    3980,    3780,   26480,    3380,     840,
    1000,    1000,   26400,     800,     700,    1040,    1020,   26100,    1540,     840,
    1000,    4100,   26400,    4800,    4100,    1140,    3680,   26240,    4240,    3460,
    1100,    3300,   26400,    3600,    4300,    1160,    3520,   26440,    3560,    3100,
    1100,    1100,   25700,    3100,    2900,    1464,     980,   26280,    3620,    3320,
    3900,    1000,   26700,    1000,    3800,    4380,     960,   26480,     900,    2820,
    4300,    3800,   26500,    4100,     800,    4440,    3660,   26300,    3760,    1600,
    4600,    3300,   26500,     800,    4600,    4480,    3540,   26440,     880,    4340,
    4600,    5100,   26500,    3100,    2800,    4760,    4080,   26480,    3240,    2760,
    4800,    3600,   26200,    2900,    2900,    4340,    3600,   26400,    3900,    3900,
    4800,    3300,   26500,    4300,    4800,    4620,    3600,   26340,    3580,    3440,
    4600,    3300,   25700,    4300,    4600,    4520,    3800,   25960,    4080,    4000,
    1000,    3600,   26500,    3900,    4800,    1060,    3680,   26140,    3360,    3300,
    1100,    3600,   26400,    3400,    2600,    1180,    4560,   26420,    3560,    3440,
    1800,    3600,   26400,    3300,     700,    1240,    3700,   26180,    3680,     840,
    5100,    1100,   26500,    1000,    4600,    4920,    1000,   26400,     920,    3900,
    1300,    3600,   25900,    4600,     800,    1180,    3820,   26180,    4420,     960,
    1000,    3300,   26500,    4300,    4800,    1160,    3500,   26360,    4120,    4000,
    1300,    3600,   26100,    1000,    2900,    1060,    3780,   26220,     860,    2340,
    4800,     800,   25700,    4100,    2900,    4480,     860,   26120,    4020,    3940,
    4600,    1000,   26200,    4300,    4800,    4640,     940,   26180,    4320,    4340,
    4800,    5200,   25900,    1000,     800,    4840,    4000,   26300,    1000,     880,
    1100,    1000,   26700,    3900,    2600,    1160,    1020,   26540,    3100,    2900,
    1000,    1000,   26500,    4100,     700,    1100,    1480,   26320,    3400,     860,
    4400,    3900,   26500,    4100,    1000,    4340,    4600,   26360,    4380,     940,
    3900,    1000,   26100,     800,    3100,    4060,     980,   26360,     800,    3740,
    4600,     800,   25900,    3300,    4300,    4720,    1000,   26100,    3260,    3160,
    1500,    3400,   25900,    4100,    2800,    1220,    3520,   26100,    3960,    3240,
    4100,    3300,   26700,    2900,    1000,    4320,    4060,   26500,    2900,     860,
    1100,    4800,   25700,     700,    1000,    1060,    3980,   26120,     820,     780,
    4300,     800,   26400,    4100,    4300,    4320,     860,   26280,    3740,    2740,
    4300,     700,   26400,     800,    4800,    4560,     820,   26300,     820,    3400,
    5100,    1100,   26200,    3800,    4400,    4900,     980,   26300,    3560,    3760,
    4400,    3300,   26100,     800,    4600,    4520,    3500,   26220,     880,    3120,
    4800,    1000,   26100,    4300,    3300,    4820,     960,   26140,    4300,    3960,
    1300,     800,   26200,    4100,    2600,    1220,     880,   26200,    4260,    3400,
    1300,    1000,   26200,    4300,    2600,    1160,     980,   26180,    3800,    3040,
    4300,    4900,   26400,    4400,    4100,    4500,    4280,   26340,    3360,    3140,
    1300,    3300,   26200,     800,     700,    1180,    3780,   26300,     860,    1680,
     800,    3400,   26500,     800,    4400,    1100,    3520,   26540,     760,    3140,
    1100,    4600,   26400,    4800,    3900,    1040,    3840,   26260,    4120,    3440,
     800,    1100,   25900,     800,    4600,    1000,     980,   26220,     800,    3360,
    1100,    3400,   26400,    3600,    2600,    1080,    3560,   26360,    3640,    2640,
    4300,    5100,   26500,    4400,    3900,    4620,    3900,   26380,    4220,    3640,
    4900,    5100,   26200,    3300,    1000,    4740,    4300,   26240,    3260,     900,
    1300,    4100,   26100,    3100,     800,    1816,    3940,   26280,    3380,     800,
    3800,    3800,   26100,     700,    3900,    3880,    3880,   26360,     800,    4060,
    3900,    3600,   26500,    2900,    3800,    4400,    4040,   26420,    2860,    2900,
    4800,     800,   26200,    3300,    1000,    5140,     940,   26360,    3360,     900,
    1300,    1000,   26500,    3900,    4800,    1040,     980,   26440,    4280,    4240,
    1000,    1000,   26700,     700,     800,    1740,     920,   26560,     820,     880,
    4400,    1000,   26200,     800,    1500,    4560,    1020,   26300,     840,    1060,
    1300,    1000,   26500,    4600,    4300,    1100,     960,   26360,    4440,    4140,
    3900,    1000,   26700,    4100,     800,    3940,     920,   26420,    4020,     960,
    1300,    5200,   26700,    2800,    2600,    1220,    4420,   26480,    3200,    3400,
    1100,     800,   26700,    3900,    4100,    1180,     900,   26500,    3160,    2940,
    4800,     700,   26400,    4300,    4600,    4440,     960,   26400,    3480,    4140,
    1100,    1100,   26400,    4300,    2800,    1180,     940,   26360,    3460,    2860,
    4300,    1000,   26400,    4400,     800,    5216,     900,   26240,    3960,     860,
    1300,    5200,   26400,    1000,    2900,    1200,    4080,   26260,     860,    4040,
    3900,    4300,   26700,    4100,     800,    4080,    3840,   26460,    3300,     880,
    1100,    3300,   26200,     800,    4400,    1160,    3660,   26220,     760,    2820,
    4300,     800,   25700,    4600,    1000,    4320,     940,   26020,    4060,     900,
    3900,    5100,   26700,     700,     700,    4080,    3980,   26520,     820,     840,
     800,     800,   26700,    3100,    4300,    1020,     880,   26540,    3700,    4040,
    1100,    1000,   26700,    1000,    1500,    1040,     920,   26500,     820,     960,
    4300,    5100,   26500,    2800,    2600,    4360,    3940,   26400,    3560,    3760,
    3900,    3900,   26100,    2900,    4100,    4360,    3800,   26500,    3100,    2940,
     800,    3600,   25700,    4300,     800,    1160,    3820,   26020,    4040,     840,
    1100,    3800,   26500,     800,    4300,    1200,    4340,   26340,     840,    3020,
    1100,    5200,   25900,    3100,     800,    1120,    4260,   26160,    3060,     860,
    1100,    4800,   25900,     800,    4100,    1160,    3940,   26080,     860,    3100,
    4400,    4900,   26200,    4100,    3900,    4300,    4700,   26260,    3560,    3380,
    1100,    5100,   26400,    4400,    1000,    1060,    4400,   26240,    4260,     840,
    4400,    1000,   26400,    4100,    2600,    4640,     960,   26320,    3500,    2680,
    4800,     700,   26400,     700,    3600,    4600,     940,   26340,     780,    4300,
    3900,     800,   26400,    4600,    4100,    4100,     900,   26240,    4160,    3560,
    1000,    1000,   25900,    4300,    4100,    1140,     980,   26240,    3540,    2900,
    4300,    3600,   26700,    2900,    3100,    4080,    3880,   26380,    3680,    3820,
    1000,    3600,   26500,    2800,    2600,    1100,    3600,   26340,    2940,    2580,
    4600,    5100,   26400,    3100,    2900,    4300,    4240,   26300,    3980,    3960,
    4600,    5100,   25700,     800,    2600,    4440,    4140,   26020,     740,    3560,
    1100,    5100,   26500,     700,    4100,    1180,    4120,   26400,     800,    4160,
    4400,    1000,   26400,    4900,    4100,    4540,     900,   26320,    4460,    3900,
    1500,    4100,   25700,    3100,    1000,    1240,    3900,   26160,    3660,     920,
    1300,    5100,   26200,    3800,    4100,    1240,    3940,   26400,    3260,    3300,
    4800,     800,   26500,    3100,    3300,    4500,     880,   26320,    4040,    4080,
    5100,    3800,   26400,     800,    2600,    4860,    3920,   26360,     780,    3640,
    4300,    4900,   25700,     700,     800,    4220,    4060,   26040,     760,     840,
    4800,    3600,   25700,    4100,    1000,    4660,    4040,   25920,    3900,     860,
    4600,    3800,   26500,    2900,     700,    4520,    4600,   26420,    3340,     780,
    4800,    4900,   26700,    2900,    2600,    4480,    4020,   26460,    3120,    3500,
    4300,    3800,   26400,     800,    1000,    5255,    3780,   26360,     800,     940,
    1100,    3800,   26400,    3100,    2500,    1180,    3920,   26400,    3020,    3940,
    4300,     700,   25700,    4100,    4100,    4440,     920,   26060,    3260,    3160,
    1300,    4900,   26400,    4600,     800,    1220,    3760,   26400,    4360,     740,
    1300,    3600,   26500,    4100,    2600,    1200,    3680,   26340,    3880,    3000,
    3800,    1100,   26500,    3100,    4300,    4260,    1060,   26380,    3600,    4200,
    3900,    1100,   26500,    4300,    4100,    3940,    1000,   26240,    4100,    4060,
    4300,    4600,   25900,     800,    1000,    4420,    4720,   26320,     840,    1000,
    3900,     800,   26500,    2900,    4100,    4060,     860,   26320,    3080,    4140,
    1100,    3300,   26400,    3300,    3100,    1080,    3540,   26300,    4100,    4080,
    1300,    3800,   26400,    3800,    4100,    1160,    4380,   26360,    4260,    4100,
    4100,    4300,   26100,     800,    4100,    4140,    4560,   26260,     800,    4100,
    1100,    3400,   26500,    4600,     700,    1080,    3540,   26460,    4500,     820,
    1000,    4800,   25700,     800,    2600,    1200,    3920,   26080,     760,    3460,
    1300,    3900,   26200,    4800,    4100,    1160,    3760,   26220,    4380,    3680,
    4400,    3600,   26400,     800,    2900,    5176,    3700,   26300,     860,    3600,
    1000,    3400,   26500,    4100,    4600,    1120,    4260,   26340,    3300,    3260,
    1100,     800,   25900,    3600,    2600,    1160,     960,   26220,    3140,    2700,
    4600,    1100,   25900,    4100,    2600,    4380,    1020,   26260,    4220,    3800,
    4900,    1100,   26400,    3600,    3100,    4580,     980,   26000,    4320,    3560,
     800,    5200,   26500,    2900,    1000,    1020,    3900,   26300,    3920,     920,
    3900,    3800,   25900,    1000,    4600,    4400,    3700,   26200,     860,    3800,
    1100,    5100,   26500,    2900,    2800,    1060,    4100,   26480,    2980,    2700,
    3900,    1000,   26200,     800,    1000,    4200,    1480,   26440,     780,     920,
     800,    5200,   26100,     700,    2600,    1200,    4100,   26180,     760,    3480,
    4600,    3600,   26200,    3800,    2500,    4560,    3520,   26160,    3160,    2540,
    4300,    3600,   25900,    4300,    1000,    4400,    4460,   26240,    3800,     900,
    4400,    1100,   25900,    2900,    2600,    4400,     860,   26380,    2880,    2620,
    4300,    1000,   26500,    3100,    4300,    4812,    1040,   26360,    3060,    3140,
    1000,     800,   25900,    3900,    4100,    1200,     920,   26180,    3380,    4320,
    1100,    3600,   26400,     800,    1000,    1200,    4640,   26300,     780,     940,
    4300,    1100,   25700,    3800,    2600,    4400,    1100,   26240,    3880,    3340,
    4400,    5100,   26400,    4400,     700,    4460,    4280,   26420,    3480,     760,
    4800,    5200,   26500,     700,    2800,    4440,    4140,   26180,     860,    3920,
    4800,     800,   25900,    3100,    2800,    4600,     880,   26240,    3600,    2680,
    3800,    3600,   26500,    2900,     700,    4180,    3820,   26380,    2860,     820,
    1000,    1100,   26400,    4600,    3900,    1160,    1000,   26020,    4200,    3460,
    1100,    1000,   25900,    3100,    4300,    1140,     900,   26300,    3100,    4220,
     800,    3100,   26100,    3300,    1000,     980,    3780,   26260,    3360,     900,
    1100,    1600,   26500,    1000,    1000,    1080,     980,   26520,     880,     900,
     800,    4600,   26100,    2900,    2900,     980,    3800,   26320,    3860,    3900,
     800,    5100,   25900,    4300,     700,    1020,    4020,   26320,    3760,     840,
    1000,    5200,   25900,     800,    2900,    1100,    4140,   26220,     880,    2820,
    4300,     700,   26100,    2800,    2500,    4480,     820,   26200,    2860,    2660,
    4900,    3400,   26200,    3100,    1000,    4780,    3360,   26300,    3840,     840,
    4900,    3600,   25900,    2900,    1000,    4380,    3960,   26280,    3060,     960,
    1000,    3400,   26400,     800,    4100,    1080,    4540,   26440,     780,    3580,
    4600,    3300,   26500,    4300,    2800,    4620,    3620,   26340,    4080,    3160,
    1000,     800,   25900,    3900,    2800,    1100,     840,   26080,    3460,    2740,
    4800,    3400,   25900,     800,    3300,    4660,    3860,   26060,     840,    4160,
    1100,    1000,   26100,    3600,    1000,    1100,     940,   26200,    2620,    1000,
    4800,     800,   25900,    4400,    1000,    4860,     980,   26200,    4380,     880,
    1300,    1000,   26400,     700,    4800,    1160,    1020,   26300,     780,    4480,
    1100,     800,   25700,    3100,    3100,    1180,     880,   25940,    3820,    3660,
    4100,    5100,   26400,    3800,    4100,    4100,    4160,   26440,    3220,    3560,
    4300,    1000,   26400,     800,     700,    4440,    1000,   26500,     820,    1580,
    1300,    4800,   26400,    3900,    4100,    1100,    4440,   26540,    3880,    4060,
    3900,    3400,   26500,     800,    4100,    4000,    3560,   26540,     820,    3860,
    4400,    3800,   26100,     800,    1000,    4400,    4780,   26300,     800,     940,
    4400,     800,   26500,    3600,    2500,    4280,     920,   26440,    2980,    2680,
    1100,    3800,   25900,    4600,    3800,    1080,    3960,   25980,    4260,    4060,
    3900,    5100,   26500,    3900,     800,    4220,    4200,   26300,    3280,     840,
     800,    5100,   26500,    4300,    3900,    1080,    4260,   26420,    3580,    3260,
    1100,     800,   25900,    1000,    3300,    1220,     840,   26260,     800,    4180,
    1300,    1500,   26500,    1000,    2900,    1180,    1020,   26460,     920,    3640,
    1100,    5100,   25900,    4400,    4100,    1100,    3960,   26180,    3760,    3980,
    4400,     700,   26700,    2800,    2600,    4440,     820,   26220,    3420,    2860,
    1100,    3400,   26700,     700,    1500,    1120,    3760,   26340,     720,     960,
     800,     800,   26400,    4800,    1000,    1000,     940,   26320,    4520,     860,
    1000,    5100,   25900,    4300,    4100,    1160,    4140,   26220,    3360,    3060,
    4300,    3800,   26700,    2900,    2800,    4320,    4300,   26320,    2860,    2760,
    1100,     800,   26700,    2900,    2500,    1680,     980,   26500,    3380,    3200,
    1000,     700,   26200,    4100,    4600,    1040,     840,   26300,    3340,    3160,
    1000,    4900,   26200,     800,    4100,    1100,    4060,   26160,     760,    4260,
    3900,    3900,   26700,    2900,    2900,    4180,    3660,   26500,    3380,    3540,
    4800,    5200,   25900,    2900,    2800,    4600,    3960,   26180,    3180,    3120,
    4300,    5100,   25900,     800,    2600,    4360,    4160,   26200,     860,    2960,
    4400,    5100,   25900,    3100,    2600,    4380,    4300,   26100,    3680,    3220,
    3900,    1100,   26100,    1000,    2900,    4240,    1020,   26220,     860,    2780,
    4400,    1100,   26700,    1000,     800,    5299,     980,   26500,     940,     900,
     800,    4300,   25700,    4100,     800,    1140,    3800,   26020,    3500,     860,
    3900,    3900,   26700,     800,    1000,    4200,    4440,   26540,     800,     920,
    1000,    1100,   26100,     800,     700,    1820,     900,   26360,     920,     780,
    1000,    3900,   26400,    3100,    3800,    1040,    3760,   26280,    3880,    2920,
    1100,    3900,   26400,    2800,    2600,    1060,    4420,   26300,    2920,    2680,
    4300,    5100,   26200,     800,    4100,    4640,    3900,   26160,     920,    3080,
    4400,    3100,   26100,    4100,    2600,    4300,    3460,   26200,    3740,    3660,
    4400,     800,   25700,    1000,    4300,    4400,     960,   25840,     900,    3900,
    4300,    4400,   26500,    1000,    2600,    4360,    3740,   26380,     920,    3800,
    4800,    3300,   26500,    1000,    4600,    4460,    3780,   26340,     880,    4240,
    4100,    1100,   26100,    2900,    3100,    4060,     980,   26340,    3120,    3900,
     800,    1100,   25700,     800,    2800,     980,     880,   26160,     860,    3040,
    1100,    3600,   26500,    4300,     800,    1260,    4400,   26260,    3300,     900,
    4800,    3600,   26200,     800,    4800,    4720,    3440,   26300,     820,    4380,
    4100,    1000,   25900,    3100,    4400,    4140,     860,   26240,    3760,    4160,
    1800,    1000,   26500,    4300,     700,    1240,    1000,   26360,    3780,     860,
    1300,    5100,   26400,     800,    1000,    1120,    4780,   26440,     880,     840,
    1100,    1000,   26500,    3900,    1500,    1140,     920,   26440,    3500,    1020,
    3800,    3900,   26100,    3100,    1000,    3960,    4000,   26240,    2940,     840,
    4800,    3400,   25900,    1000,    4600,    4760,    3440,   26320,     800,    3500,
    4800,    1000,   25900,     700,    4800,    4680,    1020,   26140,     760,    3580,
    4800,    3300,   25700,    3100,    2800,    4760,    3580,   26120,    3400,    2900,
    1100,     700,   25700,    1000,    4300,    1140,     960,   26040,     820,    3180,
    4800,    1100,   26100,    3900,    4100,    4500,     900,   26400,    3100,    2980,
    4100,    3300,   26500,     700,    3800,    4340,    3420,   26340,     780,    4140,
    4600,    1000,   26400,    4100,    4800,    4520,     960,   26280,    4300,    4340,
    1800,    3800,   26400,    3100,    2800,    1280,    3920,   26100,    3840,    3760,
    3800,    3400,   26500,    3800,    1000,    4060,    3580,   26380,    3400,     920,
    4600,    3400,   25700,    3900,    4600,    4520,    3620,   26160,    3320,    3140,
     800,    3400,   26500,    2900,    1000,    1000,    3600,   26520,    2880,     880,
    3900,    3900,   26700,    3100,    1000,    4200,    3780,   26500,    3860,     900,
    4400,     500,   26200,    3100,    4400,    4360,     760,   26240,    3960,    4120,
    1100,    1100,   25700,    4100,    4600,    1100,     900,   25980,    3780,    3960,
    4600,    3400,   25900,    1000,    2600,    4480,    3420,   26240,     840,    2720,
    1100,    1000,   26400,    3300,    2600,    1100,    1000,   26420,    3840,    2700,
    1000,    3600,   26400,    4100,    2600,    1140,    4120,   26260,    4180,    3840,
    3800,    3800,   26700,    3900,     800,    3960,    3840,   26380,    3900,     740,
    1100,    4100,   25900,    3100,    4300,    1120,    4000,   26220,    3100,    4180,
    4800,    4100,   25900,     800,    2800,    4660,    3600,   26260,     860,    3980,
    4100,    5100,   26700,    2900,     800,    4160,    4280,   26380,    3500,     840,
    1000,    3600,   26500,    2900,    4300,    1140,    4000,   26420,    2880,    3620,
    1000,    1000,   26700,    2900,     800,    1640,     960,   26480,    3260,     860,
    1100,    4100,   26700,    2800,    2600,    1180,    3780,   26420,    2980,    2540,
    1000,    4900,   26100,    2800,    1000,    1080,    4580,   26260,    3280,     900,
     800,     700,   26500,     800,    2600,    1020,     940,   26600,     800,    2560,
    1800,    3400,   26200,    4300,     800,    1320,    3940,   26260,    3920,     880,
    4600,    3300,   25900,    4600,     800,    4460,    3620,   26260,    3440,     860,
    4900,    3400,   26500,    3900,    2800,    4660,    3720,   26220,    4280,    4020,
    1300,    3400,   26700,    1000,    2500,    1180,    4000,   26440,     920,    3720,
    1300,    3300,   26400,    3800,    2900,    1160,    3580,   26420,    3320,    2700
    };



// To run the I2C MUX.
void tcaselect ( uint8_t i2c_bus) {
  if (i2c_bus > 7 ) return;
  Wire.beginTransmission(MUX_Address);
  Wire.write(1 << i2c_bus);
  Wire.endTransmission();
  //delay(10);
}



void setup() {
  Serial.begin(9600);
  //  // To use a slightly lower 32V, 1A range (higher precision on amps):
  //  ina219.setCalibration_32V_1A();
  //  // Or to use a lower 16V, 400mA range (higher precision on volts and amps):
  //  //ina219.setCalibration_16V_400mA();

  tcaselect(1);
//  ina219_A1.begin();
//  ina219_A1.setCalibration_16V_400mA();
  ina219_B1.begin();
  ina219_B1.setCalibration_16V_400mA();
  ina219_C1.begin();
  ina219_C1.setCalibration_16V_400mA();

  tcaselect(2);
  ina219_A2.begin();
  ina219_A2.setCalibration_16V_400mA();
  ina219_B2.begin();
  ina219_B2.setCalibration_16V_400mA();
  ina219_C2.begin();
  ina219_C2.setCalibration_16V_400mA();

  pinMode(chipSelect, OUTPUT);
//  pinMode(alarm, OUTPUT);
  pinMode(HT_cont_pin, OUTPUT);
  pinMode(alarm2, OUTPUT);
  

  // see if the card is present and can be initialized:
  if (!SD.begin(chipSelect)) {
    Serial.println("SD fail");
    // don't do anything more:
    while (!SD.begin(chipSelect)) {
      digitalWrite (alarm2, 220);
      delay(50);
      digitalWrite (alarm2, 0);
      delay(500);
    }
  }
  
//  SD.begin(chipSelect);
//  digitalWrite (alarm, 0);

  PowConsFile = SD.open("PowCons.txt", FILE_WRITE);
  if (PowConsFile) {
    PowConsFile.println("New");
    PowConsFile.println("");
    PowConsFile.close();
  } else {
    Serial.println("No SD");
  }

}

float data_matrix[5][10] = {{0,0,0,0,0,0,0,0,0,0},  //Row 0
                            {0,0,0,0,0,0,0,0,0,0},  //Row 1
                            {0,0,0,0,0,0,0,0,0,0},  //Row 2
                            {0,0,0,0,0,0,0,0,0,0},  //Row 3
                            {0,0,0,0,0,0,0,0,0,0}}; //Row 4
//float data_matrix[1][5];


//float A1_power_mW;
//float B1_power_mW;
//float C1_power_mW;
//float A2_power_mW;
//float B2_power_mW;
//float C2_power_mW;

int y_pred;
int iteration = 0;                                                                 //REMOVE
int Stability_agent[5] = {-1,-1,-1,-1,-1};
float Agent_output;
int Agent_pred;
int HT_iter = 1;
int HT_status = 0;

void loop() {

  /////////////Control the HT on-off cycle//////////////
  
  if(HT_iter <=100){
    if(HT_status != -1){
      HT_status = -1; digitalWrite(HT_cont_pin, HIGH);
      delay(15);
    }
  }
  else if(HT_iter < 200){
    if (HT_status != 1){
      HT_status = 1; digitalWrite(HT_cont_pin, LOW);
      delay(15);
    }
  }
  else if(HT_iter == 200){
    digitalWrite(HT_cont_pin, LOW);
    HT_status = 1;
    HT_iter = 0;
  }
  HT_iter++;

  
 /////////////Shift data values down//////////////
  for(int column = 0; column < vec_size; column++){
    for(int row=3; row>=0; row--){
      data_matrix[row+1][column] = data_matrix[row][column];
    }
  }
  

// ///////////////Get new datapoint////////////////

  tcaselect(1);
//  A1_power_mW = ina219_A1.getPower_mW();
  data_matrix[0][0] = ina219_B1.getPower_mW(); //  B1_power_mW = ina219_B1.getPower_mW();
  data_matrix[0][1] = ina219_C1.getPower_mW(); //  C1_power_mW = ina219_C1.getPower_mW();

  tcaselect(2);
  data_matrix[0][2] = ina219_A2.getPower_mW(); //  A2_power_mW = ina219_A2.getPower_mW();
  data_matrix[0][3] = ina219_B2.getPower_mW(); //  B2_power_mW = ina219_B2.getPower_mW();
  data_matrix[0][4] = ina219_C2.getPower_mW(); //  C2_power_mW = ina219_C2.getPower_mW();


// /////////////Calculate moving averages//////////////

  for(int k=5; k<vec_size; k++){
    data_matrix[0][k] = (data_matrix[0][k-5]+data_matrix[1][k-5]+data_matrix[2][k-5]+data_matrix[3][k-5]+data_matrix[4][k-5])/5.0;
  }


// ///////////////Process new datapoint////////////////

  float new_point[10] = {data_matrix[0][0], data_matrix[0][1], data_matrix[0][2], data_matrix[0][3], data_matrix[0][4], data_matrix[0][5], data_matrix[0][6], data_matrix[0][7], data_matrix[0][8], data_matrix[0][9]};
//  float new_point[5] = {data_matrix[0][0], data_matrix[0][1], data_matrix[0][2], data_matrix[0][3], data_matrix[0][4]};


  // Calculate the decision function value: BIGsum
  float BIGsum = 0.0;
  unsigned int displayInt;
  int counter = 0;
  float x;

  iteration++;                                          //REMOVE
//  debugFile = SD.open("debug.txt", FILE_WRITE);         //REMOVE
//  if (debugFile) {                                      //REMOVE
//    debugFile.println("==============");                //REMOVE
////    debugFile.print("       Iteration: ");              //REMOVE
//    debugFile.println(iteration);                       //REMOVE
////    debugFile.println("                             "); //REMOVE
//    debugFile.close();                                  //REMOVE
//  }                                                     //REMOVE

  
  for(int row=0; row<Nsv; row++){ //  AAA

    // Find the square of Euclidean distance between the new point and one of the SVs.
    float Euc_norm_sq = 0.0;
    
    for (int k = row*vec_size; k < (row*vec_size)+vec_size; k++) {// BBB
      displayInt = pgm_read_word_near(SupportVectors + k);
      
      x = displayInt/100.00 - new_point[counter]; // keep other operations outside the sq function
      Euc_norm_sq += sq(x);
      counter++;
      
    }
//    Euc_norm_sq = sqrt(Euc_norm_sq); // This is the (final) calculated distance!!! OR IS IT??
    
//    debugFile = SD.open("debug.txt", FILE_WRITE);         //REMOVE
//    if (debugFile) {                                      //REMOVE
//      debugFile.println("");                              //REMOVE
//      debugFile.close();                                  //REMOVE
//    }                                                     //REMOVE
    
    
    counter = 0;
    float astichan = - gamma * Euc_norm_sq;
    float kernel_value = exp(astichan);
    float alf = pgm_read_word_near(alpha + row)/10000.0; // Fetch from Flash memory location: address(alpha) + row
    BIGsum += alf * kernel_value;


  

//    debugFile = SD.open("debug.txt", FILE_WRITE);         //REMOVE
//    if (debugFile) {                                      //REMOVE
//      debugFile.print(Euc_norm_sq);                       //REMOVE
//      debugFile.print(", ");                              //REMOVE
//      debugFile.print(astichan);                          //REMOVE
//      debugFile.print(", ");                              //REMOVE
//      debugFile.print(kernel_value, 4);                   //REMOVE
//      debugFile.print(",  ");                             //REMOVE
//      debugFile.print(alf, 4);                            //REMOVE
//      debugFile.print(", ");                              //REMOVE
//      debugFile.print(BIGsum, 4);                         //REMOVE
//      debugFile.println(";");                             //REMOVE
//      debugFile.close();                                  //REMOVE
//    }                                                     //REMOVE
    
  }


  
  BIGsum = BIGsum + RO;
  // Return the results
  if (BIGsum <0 ){
    // Ring the HT alarm
    y_pred = -1;
//    digitalWrite (alarm, 220);
    } else{
    y_pred = 1;
//    digitalWrite (alarm, 0);
    
  }
  
  /////////////////// Stex avelacru stability agent-i array-@ //////////////////////
  Stability_agent[0] = Stability_agent[1];
  Stability_agent[1] = Stability_agent[2];
  Stability_agent[2] = Stability_agent[3];
  Stability_agent[3] = Stability_agent[4];
  Stability_agent[4] = y_pred;
  Agent_output = Stability_agent[0] + Stability_agent[1] + Stability_agent[2] + Stability_agent[3] + Stability_agent[4];
  
  // Agent prediction result
  if (Agent_output <0 ){
    Agent_pred = -1;  digitalWrite (alarm2, 220);
    } else{
    Agent_pred = 1;  digitalWrite (alarm2, 0);
  }
  
  //////////////////////////////////////////////////////////////////////////////////




    
//////////////////////////////////////////////////////


  //  TimingFile = SD.open("Timefile.txt", FILE_WRITE);
  //  if(TimingFile){
  //    //TimingFile.print(t1);
  //    //TimingFile.print(",  ");
  //    //TimingFile.print(t2);
  //    //TimingFile.print(",  ");
  //    //TimingFile.print(t2 - t1);
  //    //TimingFile.print(",  ");
  //    //TimingFile.print(t3 - t2);
  //    //TimingFile.print(",  ");
  //    TimingFile.println(t4 - t1);
  //  }
  //  TimingFile.close();


  //  // see if the card is present and can be initialized:
  //  if (!SD.begin(chipSelect)) {
  //    Serial.println("Card failed, or not present");
  //    // don't do anything more:
  //    while (!SD.begin(chipSelect)){
  //      digitalWrite (alarm, 220);
  //      delay(50);
  //      digitalWrite (alarm, 0);
  //      delay(500);
  //      }
  //  }


// ///////////////Save info to .txt files////////////////

  PowConsFile = SD.open("PowCons.txt", FILE_WRITE);
  if (PowConsFile) {
    PowConsFile.print(iteration);            PowConsFile.print("), ");    //REMOVE
//    PowConsFile.print(A1_power_mW);          PowConsFile.print(", ");
    PowConsFile.print(data_matrix[0][0]);    PowConsFile.print(", ");
    PowConsFile.print(data_matrix[0][1]);    PowConsFile.print(", ");
    PowConsFile.print(data_matrix[0][2]);    PowConsFile.print(", ");
    PowConsFile.print(data_matrix[0][3]);    PowConsFile.print(", ");
    PowConsFile.print(data_matrix[0][4]);    PowConsFile.print(", ");
    PowConsFile.print(data_matrix[0][5]);    PowConsFile.print(", ");
    PowConsFile.print(data_matrix[0][6]);    PowConsFile.print(", ");
    PowConsFile.print(data_matrix[0][7]);    PowConsFile.print(", ");
    PowConsFile.print(data_matrix[0][8]);    PowConsFile.print(", ");
    PowConsFile.print(data_matrix[0][9]);    PowConsFile.print(", ");
    PowConsFile.print(y_pred);               PowConsFile.print(", ");
    PowConsFile.print(BIGsum, 6);            PowConsFile.print(", ");
    PowConsFile.print(Agent_pred);           PowConsFile.print(", ");
    PowConsFile.println(HT_status);
    PowConsFile.close();
  } else {
    Serial.println("No SD");
  }


}
